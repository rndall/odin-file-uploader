<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>
  </head>

  <body>
    <h1><%= heading %></h1>
    <form action="<%= locals.action %>" method="POST">
      <input
        id="name"
        name="name"
        value="<%= defaultValue %>"
        type="text"
        autofocus
        required
      />
      <a id="cancel" href="/"> 
        Cancel
      </a>
      <button type="submit">
        <%= submitBtn %>
      </button>
    </form>
  </body>
  
  <script>
    (function() {
      const prev = document.referrer
      const cancel = document.querySelector("#cancel")
      if (prev && new URL(prev).origin === location.origin) {
        cancel.href = prev
      } else if (history.length > 1) {
        cancel.addEventListener("click", (e) => {
          e.preventDefault()
          history.back()
        })
      }

      const nameInput = document.querySelector("#name")
      const val = nameInput?.value || ""
      const dot = val.lastIndexOf(".")
      const end = dot > 0 ? dot : val.length
      setTimeout(() => nameInput?.setSelectionRange(0, end), 0)
    })()
  </script>
</html>
