<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/output.css">
    <title><%= title %></title>
  </head>

  <body>
    <main class="py-6 min-h-dvh container content-center">
      <div class="mx-auto max-w-md bg-foreground p-6 rounded-lg shadow-sm">
        <form
          class="flex flex-col gap-3"
          action="<%= locals.action %>"
          method="POST"
        >
          <label
            for="name"
            class="text-white font-bold text-xl"
          >
            <%= heading %>
          </label>
          <input
            id="name"
            name="name"
            value="<%= defaultValue %>"
            type="text"
            autofocus
            required
          />
          <%- include("partials/error", { field: "name" }) %>
          <div class="text-white font-bold justify-end flex gap-4 items-center mt-5">
            <a class="bg-gray-700 py-2.5 px-5 rounded-lg" id="cancel" href="/"> 
              Cancel
            </a>
            <button class="bg-primary py-2.5 px-5 rounded-lg" type="submit">
              <%= submitBtn %>
            </button>
          </div>
        </form>
      </div>
    </main>
  </body>
  
  <script>
    (function() {
      const prev = document.referrer
      const cancel = document.querySelector("#cancel")
      if (prev && new URL(prev).origin === location.origin) {
        cancel.href = prev
      } else if (history.length > 1) {
        cancel.addEventListener("click", (e) => {
          e.preventDefault()
          history.back()
        })
      }

      const nameInput = document.querySelector("#name")
      const val = nameInput?.value || ""
      const dot = val.lastIndexOf(".")
      const end = dot > 0 ? dot : val.length
      setTimeout(() => nameInput?.setSelectionRange(0, end), 0)
    })()
  </script>
</html>
